{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://web4.io/schemas/lct.schema.json",
  "title": "Linked Context Token (LCT)",
  "description": "Web4 LCT with birth certificate and role-contextual MRH",
  "type": "object",
  "required": ["lct_id", "subject", "binding", "birth_certificate", "mrh", "policy"],
  "properties": {
    "lct_id": {
      "type": "string",
      "pattern": "^lct:web4:[A-Za-z0-9_-]+$",
      "description": "Globally unique LCT identifier"
    },
    "subject": {
      "type": "string",
      "pattern": "^did:web4:(key|method):[A-Za-z0-9_-]+$",
      "description": "DID of the entity this LCT represents"
    },
    "binding": {
      "type": "object",
      "required": ["entity_type", "public_key", "created_at", "binding_proof"],
      "properties": {
        "entity_type": {
          "type": "string",
          "enum": ["human", "ai", "organization", "role", "task", "resource", "device", "service", "oracle", "accumulator", "dictionary", "hybrid", "policy", "infrastructure"]
        },
        "public_key": {
          "type": "string",
          "pattern": "^[A-Za-z0-9_-]+$",
          "description": "Multibase-encoded public key"
        },
        "hardware_anchor": {
          "type": "string",
          "pattern": "^eat:[A-Za-z0-9_-]+$",
          "description": "Optional EAT attestation"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "binding_proof": {
          "type": "string",
          "pattern": "^cose:[A-Za-z0-9_-]+$"
        }
      }
    },
    "birth_certificate": {
      "type": "object",
      "required": ["issuing_society", "citizen_role", "context", "birth_timestamp", "birth_witnesses"],
      "properties": {
        "issuing_society": {
          "type": "string",
          "pattern": "^lct:web4:[A-Za-z0-9_-]+$",
          "description": "LCT of the society issuing this birth certificate"
        },
        "citizen_role": {
          "type": "string",
          "pattern": "^lct:web4:role:citizen:[a-z]+$",
          "description": "Citizen role LCT for this entity's context"
        },
        "context": {
          "type": "string",
          "enum": ["nation", "platform", "network", "organization", "ecosystem"],
          "description": "Birth context"
        },
        "birth_timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "parent_entity": {
          "type": "string",
          "pattern": "^lct:web4:[A-Za-z0-9_-]+$"
        },
        "birth_witnesses": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "pattern": "^lct:web4:[A-Za-z0-9_-]+$"
          }
        }
      }
    },
    "mrh": {
      "type": "object",
      "required": ["bound", "paired", "horizon_depth", "last_updated"],
      "properties": {
        "bound": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["lct_id", "type", "ts"],
            "properties": {
              "lct_id": {"type": "string"},
              "type": {"type": "string", "enum": ["parent", "child", "sibling"]},
              "ts": {"type": "string", "format": "date-time"}
            }
          }
        },
        "paired": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": ["lct_id", "ts"],
            "properties": {
              "lct_id": {"type": "string"},
              "pairing_type": {"type": "string", "enum": ["birth_certificate", "role", "operational"]},
              "permanent": {"type": "boolean"},
              "context": {"type": "string"},
              "session_id": {"type": "string"},
              "ts": {"type": "string", "format": "date-time"}
            }
          }
        },
        "witnessing": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["lct_id", "role", "last_attestation"],
            "properties": {
              "lct_id": {"type": "string"},
              "role": {"type": "string", "enum": ["time", "audit", "oracle", "peer", "existence", "action", "state", "quality"]},
              "last_attestation": {"type": "string", "format": "date-time"}
            }
          }
        },
        "horizon_depth": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 3
        },
        "last_updated": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "policy": {
      "type": "object",
      "required": ["capabilities"],
      "properties": {
        "capabilities": {
          "type": "array",
          "items": {"type": "string"}
        },
        "constraints": {
          "type": "object",
          "additionalProperties": true
        }
      }
    },
    "t3_tensor": {
      "type": "object",
      "description": "Trust tensor with 3 canonical root dimensions (Talent/Training/Temperament). Each is an aggregate of an open-ended RDF sub-dimension graph.",
      "required": ["talent", "training", "temperament"],
      "properties": {
        "talent": {"type": "number", "minimum": 0, "maximum": 1},
        "training": {"type": "number", "minimum": 0, "maximum": 1},
        "temperament": {"type": "number", "minimum": 0, "maximum": 1},
        "sub_dimensions": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "additionalProperties": {"type": "number"}
          }
        },
        "composite_score": {"type": "number", "minimum": 0, "maximum": 1},
        "last_computed": {"type": "string", "format": "date-time"},
        "computation_witnesses": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    "v3_tensor": {
      "type": "object",
      "description": "Value tensor with 3 canonical root dimensions (Valuation/Veracity/Validity). Follows same fractal sub-dimension pattern as T3.",
      "required": ["valuation", "veracity", "validity"],
      "properties": {
        "valuation": {"type": "number", "minimum": 0},
        "veracity": {"type": "number", "minimum": 0, "maximum": 1},
        "validity": {"type": "number", "minimum": 0, "maximum": 1},
        "sub_dimensions": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "additionalProperties": {"type": "number"}
          }
        },
        "composite_score": {"type": "number", "minimum": 0, "maximum": 1},
        "last_computed": {"type": "string", "format": "date-time"},
        "computation_witnesses": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    "attestations": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["witness", "type", "sig", "ts"],
        "properties": {
          "witness": {"type": "string"},
          "type": {"type": "string"},
          "sig": {"type": "string"},
          "ts": {"type": "string", "format": "date-time"}
        }
      }
    },
    "lineage": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["reason", "ts"],
        "properties": {
          "parent": {"type": "string"},
          "reason": {"type": "string", "enum": ["genesis", "rotation", "fork", "upgrade"]},
          "ts": {"type": "string", "format": "date-time"}
        }
      }
    },
    "revocation": {
      "type": "object",
      "required": ["status"],
      "properties": {
        "status": {"type": "string", "enum": ["active", "revoked"]},
        "ts": {"type": "string", "format": "date-time"},
        "reason": {"type": "string", "enum": ["compromise", "superseded", "expired"]}
      }
    }
  },
  "additionalProperties": false
}